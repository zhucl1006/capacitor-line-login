# Capacitor Line Login Plugin - å®Œæ•´é›†æˆæŒ‡å—

## ğŸ“‹ ç›®å½•

1. [é¡¹ç›®æ¦‚è¿°](#é¡¹ç›®æ¦‚è¿°)
2. [å¼€å‘ä»»åŠ¡è§„åˆ’](#å¼€å‘ä»»åŠ¡è§„åˆ’)
3. [æŠ€æœ¯è¦æ±‚](#æŠ€æœ¯è¦æ±‚)
4. [å®‰è£…å’Œé…ç½®](#å®‰è£…å’Œé…ç½®)
5. [å¹³å°ç‰¹å®šé…ç½®](#å¹³å°ç‰¹å®šé…ç½®)
6. [API å‚è€ƒ](#api-å‚è€ƒ)
7. [ä½¿ç”¨ç¤ºä¾‹](#ä½¿ç”¨ç¤ºä¾‹)
8. [æµ‹è¯•ç­–ç•¥](#æµ‹è¯•ç­–ç•¥)
9. [æ•…éšœæ’é™¤](#æ•…éšœæ’é™¤)
10. [å¼€å‘è¿›åº¦è·Ÿè¸ª](#å¼€å‘è¿›åº¦è·Ÿè¸ª)

## ğŸ¯ é¡¹ç›®æ¦‚è¿°

æœ¬é¡¹ç›®æ˜¯ä¸€ä¸ªæ”¯æŒAndroidã€iOSå’ŒWebå¹³å°çš„Line Login Capacitoræ’ä»¶ï¼ŒåŸºäºTaskMaster AIè¿›è¡Œé¡¹ç›®ç®¡ç†å’Œä»»åŠ¡è§„åˆ’ã€‚

### æ ¸å¿ƒåŠŸèƒ½
- âœ… ç”¨æˆ·ç™»å½•/ç™»å‡º
- âœ… è·å–ç”¨æˆ·ä¿¡æ¯
- âœ… ä»¤ç‰Œç®¡ç†å’Œåˆ·æ–°
- âœ… ç™»å½•çŠ¶æ€æ£€æŸ¥
- âœ… è·¨å¹³å°æ”¯æŒï¼ˆAndroid/iOS/Webï¼‰

## ğŸ“Š å¼€å‘ä»»åŠ¡è§„åˆ’

### TaskMaster AI ç”Ÿæˆçš„ä»»åŠ¡åˆ—è¡¨

åŸºäºå¤æ‚åº¦åˆ†æï¼Œæˆ‘ä»¬æœ‰ä»¥ä¸‹15ä¸ªä¸»è¦ä»»åŠ¡ï¼š

| ä»»åŠ¡ID | ä»»åŠ¡åç§° | å¤æ‚åº¦ | ä¼˜å…ˆçº§ | çŠ¶æ€ | å­ä»»åŠ¡æ•° |
|--------|----------|--------|---------|------|----------|
| 1 | è®¾ç½®é¡¹ç›®ä»“åº“ | 3 | medium | pending | 2 |
| 2 | å®šä¹‰ TypeScript æ¥å£ | 4 | medium | pending | 3 |
| 3 | åˆå§‹åŒ– Capacitor æ’ä»¶ | 4 | medium | pending | 2 |
| 4 | å®ç°æ’ä»¶åˆå§‹åŒ–åŠŸèƒ½ | 6 | high | pending | 3 |
| 5 | å®ç°ç”¨æˆ·ç™»å½•åŠŸèƒ½ | 8 | high | pending | 4 |
| 6 | å®ç°è·å–ç”¨æˆ·ä¿¡æ¯åŠŸèƒ½ | 5 | medium | pending | 3 |
| 7 | å®ç°ç™»å½•çŠ¶æ€ç®¡ç†åŠŸèƒ½ | 5 | medium | pending | 3 |
| 8 | å®ç°ç”¨æˆ·ç™»å‡ºåŠŸèƒ½ | 5 | medium | pending | 3 |
| 9 | å®ç°ä»¤ç‰Œç®¡ç†åŠŸèƒ½ | 6 | medium | pending | 3 |
| 10 | é›†æˆ Android SDK | 7 | high | pending | 3 |
| 11 | é›†æˆ iOS SDK | 7 | high | pending | 3 |
| 12 | å®ç° Web ç™»å½•åŠŸèƒ½ | 6 | medium | pending | 3 |
| 13 | ç¼–å†™æ–‡æ¡£ | 5 | medium | pending | 3 |
| 14 | å®ç°è‡ªåŠ¨åŒ–æµ‹è¯•æµç¨‹ | 6 | medium | pending | 3 |
| 15 | å‘å¸ƒå‡†å¤‡ | 5 | high | pending | 3 |

### å¤æ‚åº¦åˆ†æç»“æœ
- **é«˜å¤æ‚åº¦ä»»åŠ¡ (â‰¥7)**: 3ä¸ª (ä»»åŠ¡5, 10, 11)
- **ä¸­å¤æ‚åº¦ä»»åŠ¡ (5-6)**: 8ä¸ª
- **ä½å¤æ‚åº¦ä»»åŠ¡ (â‰¤4)**: 4ä¸ª

## ğŸ›  æŠ€æœ¯è¦æ±‚

### Line SDK ç‰ˆæœ¬
- **Android**: Line SDK for Android 5.8.1+
- **iOS**: Line SDK for iOS 5.8.0+
- **Web**: Line Login Web API v2.1+

### å¼€å‘ç¯å¢ƒ
- **Capacitor**: 5.0+
- **Node.js**: 16.0+
- **TypeScript**: 4.0+
- **iOS**: iOS 13.0+, Xcode 14.0+
- **Android**: API Level 24+, Java 8+

## ğŸ“¦ å®‰è£…å’Œé…ç½®

### 1. åŸºç¡€å®‰è£…

```bash
# å®‰è£…æ’ä»¶
npm install capacitor-line-login

# åŒæ­¥åˆ°åŸç”Ÿé¡¹ç›®
npx cap sync
```

### 2. Line Developer Console é…ç½®

1. è®¿é—® [Line Developer Console](https://developers.line.biz/console/)
2. åˆ›å»ºæ–°çš„Provideræˆ–ä½¿ç”¨ç°æœ‰çš„
3. åˆ›å»ºLine Login Channel
4. è·å–ä»¥ä¸‹ä¿¡æ¯ï¼š
   - **Channel ID**: ç”¨äºåˆå§‹åŒ–SDK
   - **Channel Secret**: ç”¨äºæœåŠ¡å™¨ç«¯éªŒè¯
   - **Callback URL**: é…ç½®å›è°ƒåœ°å€

## ğŸ”§ å¹³å°ç‰¹å®šé…ç½®

### Android é…ç½®

#### 1. æ·»åŠ ä¾èµ– (æ ¹æ®ä»»åŠ¡10.1)
```gradle
// android/build.gradle
dependencies {
    implementation 'com.linecorp.linesdk:linesdk:5.8.1'
}
```

#### 2. é…ç½® AndroidManifest.xml (æ ¹æ®ä»»åŠ¡10.3)
```xml
<!-- android/src/main/AndroidManifest.xml -->
<manifest xmlns:android="http://schemas.android.com/apk/res/android">
    <application>
        <!-- Line SDK Activity -->
        <activity
            android:name="com.linecorp.linesdk.auth.LineAuthenticationActivity"
            android:exported="true"
            android:launchMode="singleTop"
            android:theme="@style/Theme.AppCompat.Light.NoActionBar">
            <intent-filter>
                <action android:name="android.intent.action.VIEW" />
                <category android:name="android.intent.category.DEFAULT" />
                <category android:name="android.intent.category.BROWSABLE" />
                <data android:scheme="line3rdp.{your_channel_id}" />
            </intent-filter>
        </activity>
        
        <!-- Channel ID -->
        <meta-data
            android:name="com.linecorp.linesdk.ChannelId"
            android:value="@string/line_channel_id" />
    </application>
</manifest>
```

#### 3. é…ç½®å­—ç¬¦ä¸²èµ„æº
```xml
<!-- android/src/main/res/values/strings.xml -->
<resources>
    <string name="line_channel_id">YOUR_CHANNEL_ID</string>
</resources>
```

### iOS é…ç½®

#### 1. æ·»åŠ ä¾èµ– (æ ¹æ®ä»»åŠ¡11.1)
```swift
// Package.swift
dependencies: [
    .package(url: "https://github.com/line/line-sdk-ios-swift.git", from: "5.8.0")
]
```

æˆ–ä½¿ç”¨ CocoaPodsï¼š
```ruby
# Podfile
pod 'LineSDKSwift', '~> 5.8.0'
```

#### 2. é…ç½® URL Scheme (æ ¹æ®ä»»åŠ¡11.2)
```xml
<!-- ios/App/App/Info.plist -->
<key>CFBundleURLTypes</key>
<array>
    <dict>
        <key>CFBundleURLName</key>
        <string>line3rdp.{your_channel_id}</string>
        <key>CFBundleURLSchemes</key>
        <array>
            <string>line3rdp.{your_channel_id}</string>
        </array>
    </dict>
</array>
```

#### 3. é…ç½® Universal Links (æ ¹æ®ä»»åŠ¡11.3)
```xml
<!-- ios/App/App/Info.plist -->
<key>com.apple.developer.associated-domains</key>
<array>
    <string>applinks:access.line.me</string>
</array>
```

### Web é…ç½®

#### 1. é…ç½®åŸŸåç™½åå•
åœ¨Line Developer Consoleä¸­é…ç½®å…è®¸çš„åŸŸåï¼š
- `http://localhost:8100` (å¼€å‘ç¯å¢ƒ)
- `https://yourdomain.com` (ç”Ÿäº§ç¯å¢ƒ)

#### 2. é…ç½®å›è°ƒURL
```javascript
// å¼€å‘ç¯å¢ƒ
http://localhost:8100/callback

// ç”Ÿäº§ç¯å¢ƒ
https://yourdomain.com/callback
```

## ğŸ”Œ API å‚è€ƒ

### TypeScript æ¥å£å®šä¹‰ (æ ¹æ®ä»»åŠ¡2)

```typescript
// src/definitions.ts
export interface LineLoginPlugin {
  /**
   * åˆå§‹åŒ–Line Login SDK
   */
  initialize(options: LineLoginConfig): Promise<void>;
  
  /**
   * æ‰§è¡ŒLineç™»å½•
   */
  login(options?: LoginOptions): Promise<LoginResult>;
  
  /**
   * è·å–ç”¨æˆ·ä¿¡æ¯
   */
  getUserProfile(): Promise<UserProfile>;
  
  /**
   * æ£€æŸ¥ç™»å½•çŠ¶æ€
   */
  isLoggedIn(): Promise<{ isLoggedIn: boolean }>;
  
  /**
   * ç™»å‡º
   */
  logout(): Promise<void>;
  
  /**
   * åˆ·æ–°è®¿é—®ä»¤ç‰Œ
   */
  refreshToken(): Promise<TokenResult>;
}

export interface LineLoginConfig {
  channelId: string;
  universalLinkURL?: string;
}

export interface LoginOptions {
  onlyWebLogin?: boolean;
  botPrompt?: 'normal' | 'aggressive';
}

export interface LoginResult {
  accessToken: string;
  expiresIn: number;
  refreshToken?: string;
  scope: string;
  tokenType: string;
  userProfile: UserProfile;
}

export interface UserProfile {
  userId: string;
  displayName: string;
  pictureUrl?: string;
  statusMessage?: string;
}

export interface TokenResult {
  accessToken: string;
  expiresIn: number;
  refreshToken?: string;
}
```

## ğŸ’» ä½¿ç”¨ç¤ºä¾‹

### åŸºç¡€ä½¿ç”¨

```typescript
import { LineLogin } from 'capacitor-line-login';

// åˆå§‹åŒ–
await LineLogin.initialize({
  channelId: 'YOUR_CHANNEL_ID'
});

// ç™»å½•
try {
  const result = await LineLogin.login();
  console.log('ç™»å½•æˆåŠŸ:', result);
  
  // è·å–ç”¨æˆ·ä¿¡æ¯
  const profile = await LineLogin.getUserProfile();
  console.log('ç”¨æˆ·ä¿¡æ¯:', profile);
  
} catch (error) {
  console.error('ç™»å½•å¤±è´¥:', error);
}

// æ£€æŸ¥ç™»å½•çŠ¶æ€
const { isLoggedIn } = await LineLogin.isLoggedIn();
if (isLoggedIn) {
  console.log('ç”¨æˆ·å·²ç™»å½•');
}

// ç™»å‡º
await LineLogin.logout();
```

### React ç»„ä»¶ç¤ºä¾‹

```tsx
import React, { useState, useEffect } from 'react';
import { LineLogin } from 'capacitor-line-login';

const LineLoginComponent: React.FC = () => {
  const [user, setUser] = useState<any>(null);
  const [isLoggedIn, setIsLoggedIn] = useState(false);

  useEffect(() => {
    initializeLineLogin();
  }, []);

  const initializeLineLogin = async () => {
    await LineLogin.initialize({
      channelId: 'YOUR_CHANNEL_ID'
    });
    
    const { isLoggedIn } = await LineLogin.isLoggedIn();
    setIsLoggedIn(isLoggedIn);
    
    if (isLoggedIn) {
      const profile = await LineLogin.getUserProfile();
      setUser(profile);
    }
  };

  const handleLogin = async () => {
    try {
      const result = await LineLogin.login();
      setUser(result.userProfile);
      setIsLoggedIn(true);
    } catch (error) {
      console.error('ç™»å½•å¤±è´¥:', error);
    }
  };

  const handleLogout = async () => {
    await LineLogin.logout();
    setUser(null);
    setIsLoggedIn(false);
  };

  return (
    <div>
      {isLoggedIn ? (
        <div>
          <h3>æ¬¢è¿, {user?.displayName}!</h3>
          <img src={user?.pictureUrl} alt="å¤´åƒ" />
          <button onClick={handleLogout}>ç™»å‡º</button>
        </div>
      ) : (
        <button onClick={handleLogin}>Line ç™»å½•</button>
      )}
    </div>
  );
};

export default LineLoginComponent;
```

## ğŸ§ª æµ‹è¯•ç­–ç•¥

### å•å…ƒæµ‹è¯•
```typescript
// tests/line-login.test.ts
import { LineLogin } from '../src';

describe('LineLogin', () => {
  beforeEach(async () => {
    await LineLogin.initialize({
      channelId: 'test_channel_id'
    });
  });

  it('should initialize successfully', async () => {
    const result = await LineLogin.initialize({
      channelId: 'test_channel_id'
    });
    expect(result).toBeUndefined();
  });

  it('should login successfully', async () => {
    const result = await LineLogin.login();
    expect(result.accessToken).toBeDefined();
    expect(result.userProfile).toBeDefined();
  });
});
```

### é›†æˆæµ‹è¯•
```typescript
// e2e/line-login.e2e.ts
import { browser, by, element } from 'protractor';

describe('Line Login E2E', () => {
  it('should complete login flow', async () => {
    await browser.get('/');
    
    const loginButton = element(by.id('line-login-button'));
    await loginButton.click();
    
    // ç­‰å¾…ç™»å½•å®Œæˆ
    await browser.wait(() => {
      return element(by.id('user-profile')).isPresent();
    }, 10000);
    
    const userProfile = element(by.id('user-profile'));
    expect(await userProfile.isDisplayed()).toBe(true);
  });
});
```

## ğŸ” æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

#### 1. Android ç™»å½•å¤±è´¥
```
Error: LINE_SDK_ERROR: AUTHENTICATION_AGENT_ERROR
```
**è§£å†³æ–¹æ¡ˆ**:
- æ£€æŸ¥ Channel ID æ˜¯å¦æ­£ç¡®
- ç¡®è®¤ AndroidManifest.xml é…ç½®æ­£ç¡®
- éªŒè¯ Line åº”ç”¨æ˜¯å¦å·²å®‰è£…

#### 2. iOS URL Scheme é—®é¢˜
```
Error: Invalid URL scheme
```
**è§£å†³æ–¹æ¡ˆ**:
- æ£€æŸ¥ Info.plist ä¸­çš„ URL Scheme é…ç½®
- ç¡®è®¤ Universal Links é…ç½®æ­£ç¡®
- éªŒè¯ AppDelegate ä¸­çš„å›è°ƒå¤„ç†

#### 3. Web è·¨åŸŸé—®é¢˜
```
Error: CORS policy blocks request
```
**è§£å†³æ–¹æ¡ˆ**:
- åœ¨ Line Developer Console ä¸­é…ç½®æ­£ç¡®çš„åŸŸå
- ä½¿ç”¨ HTTPS åè®®ï¼ˆç”Ÿäº§ç¯å¢ƒï¼‰
- æ£€æŸ¥å›è°ƒ URL é…ç½®

### è°ƒè¯•æŠ€å·§

#### 1. å¯ç”¨è°ƒè¯•æ—¥å¿—
```typescript
// åœ¨åˆå§‹åŒ–æ—¶å¯ç”¨è°ƒè¯•æ¨¡å¼
await LineLogin.initialize({
  channelId: 'YOUR_CHANNEL_ID',
  debug: true
});
```

#### 2. æ£€æŸ¥ç½‘ç»œè¯·æ±‚
```typescript
// ç›‘å¬ç½‘ç»œè¯·æ±‚
window.addEventListener('fetch', (event) => {
  if (event.request.url.includes('line.me')) {
    console.log('Line API è¯·æ±‚:', event.request);
  }
});
```

## ğŸ“ˆ å¼€å‘è¿›åº¦è·Ÿè¸ª

### ä½¿ç”¨ TaskMaster AI è·Ÿè¸ªè¿›åº¦

```bash
# æŸ¥çœ‹å½“å‰ä»»åŠ¡çŠ¶æ€
task-master list

# æŸ¥çœ‹ä¸‹ä¸€ä¸ªè¦æ‰§è¡Œçš„ä»»åŠ¡
task-master next

# æŸ¥çœ‹ç‰¹å®šä»»åŠ¡è¯¦æƒ…
task-master show 5

# æ›´æ–°ä»»åŠ¡çŠ¶æ€
task-master set-status --id=1 --status=done

# æ·»åŠ å­ä»»åŠ¡è¿›åº¦
task-master update-subtask --id=5.1 --prompt="å®ŒæˆåŸç”Ÿç™»å½•é€»è¾‘å®ç°"
```

### é¡¹ç›®é‡Œç¨‹ç¢‘

- **é‡Œç¨‹ç¢‘ 1**: å®ŒæˆåŸºç¡€æ¶æ„æ­å»º (ä»»åŠ¡1-3)
- **é‡Œç¨‹ç¢‘ 2**: å®ç°æ ¸å¿ƒç™»å½•åŠŸèƒ½ (ä»»åŠ¡4-5)
- **é‡Œç¨‹ç¢‘ 3**: å®Œæˆå¹³å°é›†æˆ (ä»»åŠ¡10-12)
- **é‡Œç¨‹ç¢‘ 4**: æµ‹è¯•å’Œæ–‡æ¡£ (ä»»åŠ¡13-14)
- **é‡Œç¨‹ç¢‘ 5**: å‘å¸ƒå‡†å¤‡ (ä»»åŠ¡15)

## ğŸ“š å‚è€ƒèµ„æº

### å®˜æ–¹æ–‡æ¡£
- [Line Developer Documentation](https://developers.line.biz/en/docs/)
- [Line SDK for Android](https://developers.line.biz/en/docs/android-sdk/)
- [Line SDK for iOS](https://developers.line.biz/en/docs/ios-sdk/)
- [Line Login Web API](https://developers.line.biz/en/docs/line-login/)

### ç¤¾åŒºèµ„æº
- [Capacitor å®˜æ–¹æ–‡æ¡£](https://capacitorjs.com/docs)
- [TypeScript å®˜æ–¹æ–‡æ¡£](https://www.typescriptlang.org/docs/)

## ğŸ“„ è®¸å¯è¯

MIT License - è¯¦è§ LICENSE æ–‡ä»¶

---

**æ³¨æ„**: æœ¬æ–‡æ¡£åŸºäº TaskMaster AI çš„ä»»åŠ¡è§„åˆ’ç”Ÿæˆï¼Œå®é™…å¼€å‘è¿‡ç¨‹ä¸­è¯·æ ¹æ®å…·ä½“æƒ…å†µè°ƒæ•´ã€‚ 